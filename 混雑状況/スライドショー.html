<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>æ–‡åŒ–ç¥­ã‚µã‚¤ãƒãƒ¼ã‚¸</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />
    <style>
        body { margin: 0; background: #000; color: white; overflow: hidden; font-family: "Meiryo", sans-serif; }
        .swiper { width: 100vw; height: 100vh; }
        .slide-content {
            display: flex; flex-direction: column; justify-content: center;
            align-items: center; height: 100%; text-align: center;
        }
        .status-badge {
            font-size: 4rem; padding: 20px 60px; border-radius: 100px;
            font-weight: bold; margin-bottom: 40px; text-shadow: 2px 2px 10px rgba(0,0,0,0.5);
        }
        .status-ç©ºã { background: #28a745; }
        .status-æ··é›‘ { background: #ffc107; color: black; }
        .status-å£²ã‚Šåˆ‡ã‚Œãƒ»çµ‚äº† { background: #dc3545; }
        
        .project-name { font-size: 6rem; font-weight: bold; margin: 20px 0; }
        .group-name { font-size: 3rem; color: #ccc; }
        .location { font-size: 3.5rem; margin-top: 30px; color: #1a73e8; background: white; padding: 10px 40px; border-radius: 20px; }
    </style>
</head>
<body>
    <div class="swiper">
        <div class="swiper-wrapper" id="slide-container">
            <div class="swiper-slide"><div class="slide-content">Loading...</div></div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
    <script>
        const GAS_URL = "https://script.google.com/macros/s/AKfycbwGPser_Y53kvBUxZKRRBDhciy9Xk6yVUALsAYxjrgn3ktOhrlfUMI-zUJ4GePwQAvW/exec";

        async function updateData() {
            try {
                const res = await fetch(GAS_URL);
                const data = await res.json();
                const container = document.getElementById('slide-container');
                
                container.innerHTML = data.map(p => `
                    <div class="swiper-slide">
                        <div class="slide-content">
                            <div class="status-badge status-${p['çŠ¶æ³']}">${p['çŠ¶æ³']}</div>
                            <div class="group-name">${p['å›£ä½“å']}</div>
                            <div class="project-name">${p['ä¼ç”»å']}</div>
                            <div class="location">ğŸ“ ${p['å ´æ‰€(æ£Ÿ)']} ${p['å ´æ‰€(éš)']}éš</div>
                        </div>
                    </div>
                `).join('');

                const swiper = new Swiper('.swiper', {
                    loop: true,
                    autoplay: { delay: 5000 }, // 5ç§’ã”ã¨ã«åˆ‡æ›¿
                    effect: 'fade'
                });
            } catch (e) { console.error(e); }
        }
        updateData();
        setInterval(updateData, 300000); // 5åˆ†ã”ã¨ã«æœ€æ–°æƒ…å ±ã«æ›´æ–°
    </script>
</body>
</html>